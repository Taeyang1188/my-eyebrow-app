<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>çœ‰ì™„ì„±: ë‚´ ì¸ìƒ ëˆˆì¹ ì°¾ê¸°</title>
    <script src="https://cdn.jsdelivr.net/npm/face-api.js@0.22.2/dist/face-api.min.js"></script>
    <style>
        :root {
            --primary-color: #6a5acd; /* SlateBlue */
            --secondary-color: #f0e6ff;
            --text-color: #333;
            --bg-color: #f8f9fa;
            --container-bg: #ffffff;
            --border-radius: 16px;
            --shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: var(--bg-color);
            margin: 0;
            padding: 20px;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            box-sizing: border-box;
            color: var(--text-color);
        }
        .main-container {
            width: 100%;
            max-width: 500px;
            background-color: var(--container-bg);
            border-radius: var(--border-radius);
            box-shadow: var(--shadow);
            padding: 25px;
            box-sizing: border-box;
            text-align: center;
        }
        h1, h2, h3 {
            margin: 0 0 15px;
            color: var(--primary-color);
        }
        h1 { font-size: 2rem; }
        h2 { font-size: 1.6rem; }
        p { line-height: 1.7; margin: 0 0 20px; }
        .btn {
            display: block;
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 12px;
            background-color: var(--primary-color);
            color: white;
            font-size: 1.1rem;
            font-weight: bold;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
        }
        .btn:hover { background-color: #5a4ab9; }
        .btn:active { transform: scale(0.98); }
        .btn.secondary {
            background-color: #e9ecef;
            color: var(--text-color);
        }
        .btn.secondary:hover { background-color: #d3d9df; }
        .page { display: none; }
        .page.active { display: block; }
        #guide-container {
            width: 100%;
            aspect-ratio: 3 / 4;
            background-color: #e9ecef;
            border: 2px dashed #ced4da;
            border-radius: 12px;
            position: relative;
            overflow: hidden;
            user-select: none;
            margin: 20px 0;
        }
        #user-image, #overlay-canvas {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            max-width: 100%;
            max-height: 100%;
            height: auto;
            width: 80%; /* Initial size */
        }
        #user-image { cursor: grab; }
        #user-image:active { cursor: grabbing; }
        #overlay-canvas { pointer-events: none; }
        .sliders {
            margin-top: 20px;
            padding: 20px;
            background-color: #f8f9fa;
            border-radius: 8px;
        }
        .slider-group {
            display: flex;
            align-items: center;
            gap: 15px;
            margin-bottom: 15px;
        }
        .slider-group label { font-size: 14px; width: 80px; text-align: left;}
        input[type="range"] { flex-grow: 1; }
        .question { margin-bottom: 30px; text-align: left; }
        .question p { font-weight: 500; margin-bottom: 15px; }
        .options { display: flex; flex-direction: column; gap: 10px; }
        .result-card {
            background-color: var(--secondary-color);
            border-radius: 12px;
            padding: 20px;
            margin-bottom: 15px;
            text-align: left;
        }
        .result-card h3 { color: var(--primary-color); border-bottom: 2px solid var(--primary-color); padding-bottom: 10px; margin-bottom: 15px;}
        .result-card ul { padding-left: 20px; margin: 0; }
        .result-card li { margin-bottom: 10px; }
        .result-card .photo-basis {
            font-size: 0.85em;
            color: #555;
            padding-left: 8px;
        }
        #loader {
            border: 8px solid #f3f3f3;
            border-radius: 50%;
            border-top: 8px solid var(--primary-color);
            width: 60px;
            height: 60px;
            animation: spin 1s linear infinite;
            margin: 30px auto;
            display: none;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>

    <div class="main-container">

        <div id="start-page" class="page active">
            <h1>çœ‰ì™„ì„±</h1>
            <p><strong>ë‚´ ì–¼êµ´ì— ë”± ë§ëŠ” ì¸ìƒ ëˆˆì¹ì„ ì°¾ì•„ë³´ì„¸ìš”!</strong><br>ë‘ ê°€ì§€ ë°©ë²• ì¤‘ í•˜ë‚˜ë¥¼ ì„ íƒí•´ ì§„ë‹¨ì„ ì‹œì‘í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
            <button class="btn" onclick="showPage('photo-page')">ğŸ“¸ ì‚¬ì§„ìœ¼ë¡œ ë¶„ì„í•˜ê¸°</button>
            <button class="btn" onclick="showPage('quiz-page')">âœï¸ ì„¤ë¬¸ìœ¼ë¡œ ì§„ë‹¨í•˜ê¸°</button>
            <p style="font-size: 0.8em; color: #888; margin-top: 20px;">
                ì‚¬ì§„ì€ ì„œë²„ì— ì €ì¥ë˜ì§€ ì•Šìœ¼ë©°, ë¶„ì„ì€ ëª¨ë‘ ì‚¬ìš©ìì˜ ê¸°ê¸°ì—ì„œë§Œ ì´ë£¨ì–´ì§‘ë‹ˆë‹¤.
            </p>
        </div>

        <div id="photo-page" class="page">
            <h2>ì‚¬ì§„ìœ¼ë¡œ ë¶„ì„í•˜ê¸°</h2>
            <p>ì •ë©´ì„ ë°”ë¼ë³´ëŠ” ì„ ëª…í•œ ì‚¬ì§„ì„ ì˜¬ë¦¬ê³ <br>ê°€ì´ë“œë¼ì¸ì— ë§ì¶° ì–¼êµ´ì„ ì¡°ì •í•´ì£¼ì„¸ìš”.</p>
            
            <label for="file-input" class="btn secondary">ğŸ–¼ï¸ ì‚¬ì§„ ì„ íƒ</label>
            <input type="file" id="file-input" accept="image/*" style="display:none;">

            <div id="guide-container">
                <img id="user-image" src="" alt="User's face" style="display:none;">
                <canvas id="overlay-canvas"></canvas>
            </div>

            <div id="sliders-container" class="sliders" style="display:none;">
                <div class="slider-group">
                    <label for="size-slider">ì‚¬ì§„ í¬ê¸°</label>
                    <input type="range" id="size-slider" min="10" max="250" value="80">
                </div>
                <div class="slider-group">
                    <label for="opacity-slider">íˆ¬ëª…ë„</label>
                    <input type="range" id="opacity-slider" min="0" max="1" step="0.05" value="0.7">
                </div>
            </div>
            
            <div id="loader"></div>
            <button class="btn" id="analyze-btn" onclick="analyzePhoto()" style="display:none;">ê²°ê³¼ ë¶„ì„í•˜ê¸°</button>
            <button class="btn secondary" onclick="showPage('start-page')">ë’¤ë¡œ ê°€ê¸°</button>
        </div>

        <div id="quiz-page" class="page">
            <h2>ì„¤ë¬¸ìœ¼ë¡œ ì§„ë‹¨í•˜ê¸°</h2>
            <p>ì•„ë˜ ì§ˆë¬¸ì— ë‹µí•˜ì—¬<br>ìì‹ ì˜ ì–¼êµ´ íŠ¹ì§•ê³¼ ê°€ì¥ ê°€ê¹Œìš´ ê²ƒì„ ì„ íƒí•´ì£¼ì„¸ìš”.</p>
            
            <form id="quiz-form">
                <div class="question">
                    <p>1. ë‚´ ì–¼êµ´í˜•ì€ ì „ì²´ì ìœ¼ë¡œ ì–´ë–¤ ëŠë‚Œì— ê°€ê¹ë‚˜ìš”?</p>
                    <div class="options">
                        <label><input type="radio" name="q1" value="A"> ì´ë§ˆê°€ ë„“ê³  ê¸´ í¸ì´ë©°, ì–¼êµ´ì— ì—¬ë°±ì´ ë§ë‹¤.</label>
                        <label><input type="radio" name="q1" value="B"> ì´ë§ˆê°€ ì¢ê³  ì§§ì€ í¸ì´ë©°, ì–¼êµ´ì´ ê½‰ ì°¨ ë³´ì¸ë‹¤.</label>
                    </div>
                </div>
                <div class="question">
                    <p>2. ë‚´ í„±ì„ ê³¼ ì–¼êµ´ì˜ ì „ì²´ì ì¸ ì¸ìƒì€?</p>
                    <div class="options">
                        <label><input type="radio" name="q2" value="C"> í„±ì„ ì´ ë‘¥ê¸€ê³ , ë¶€ë“œëŸ½ê³  ë™ê¸€ë™ê¸€í•œ ì¸ìƒì´ë‹¤.</label>
                        <label><input type="radio" name="q2" value="D"> í„±ì„ ì´ ê°ì§€ê±°ë‚˜ ë¾°ì¡±í•˜ë©°, ì§ì„ ì ì´ê³  ë˜ë ·í•œ ì¸ìƒì´ë‹¤.</label>
                    </div>
                </div>
                <div class="question">
                    <p>3. ë‚´ ëˆˆë§¤ëŠ” ì–´ë–¤ ëª¨ì–‘ì— ê°€ê¹Œìš´ê°€ìš”?</p>
                    <div class="options">
                        <label><input type="radio" name="q3" value="E"> ëˆˆì˜ ê°€ë¡œ ê¸¸ì´ë³´ë‹¤ ì„¸ë¡œ í­ì´ ë„“ì–´ ë™ê·¸ë€ ëŠë‚Œì´ë‹¤.</label>
                        <label><input type="radio" name="q3" value="F"> ëˆˆì˜ ì„¸ë¡œ í­ë³´ë‹¤ ê°€ë¡œ ê¸¸ì´ê°€ ê¸¸ì–´ ì‹œì›í•˜ê²Œ íŠ¸ì—¬ìˆë‹¤.</label>
                    </div>
                </div>
                 <div class="question">
                    <p>4. ì´ëª©êµ¬ë¹„ê°€ ì–¼êµ´ ì¤‘ì•™ì— ëª¨ì—¬ìˆëŠ” í¸ì¸ê°€ìš”, í¼ì ¸ìˆëŠ” í¸ì¸ê°€ìš”?</p>
                    <div class="options">
                        <label><input type="radio" name="q4" value="inner"> ì´ëª©êµ¬ë¹„ê°€ ì•ˆìª½ìœ¼ë¡œ ëª¨ì—¬ìˆëŠ” ë‚´ì‹¬í˜• ì–¼êµ´ì´ë‹¤.</label>
                        <label><input type="radio" name="q4" value="outer"> ì´ëª©êµ¬ë¹„ê°€ ë°”ê¹¥ìª½ìœ¼ë¡œ í¼ì ¸ìˆëŠ” ì™¸ì‹¬í˜• ì–¼êµ´ì´ë‹¤.</label>
                    </div>
                </div>
                <button type="button" class="btn" onclick="analyzeQuiz()">ê²°ê³¼ í™•ì¸í•˜ê¸°</button>
                <button type="button" class="btn secondary" onclick="showPage('start-page')">ë’¤ë¡œ ê°€ê¸°</button>
            </form>
        </div>

        <div id="result-page" class="page">
            <h2>ì§„ë‹¨ ê²°ê³¼ ğŸ§</h2>
            <p>ë‹¹ì‹ ì—ê²Œ ì–´ìš¸ë¦¬ëŠ” ìµœê³ ì˜ ëˆˆì¹ ìŠ¤íƒ€ì¼ì„ ì¶”ì²œí•©ë‹ˆë‹¤!</p>
            <div id="result-content"></div>
            <button class="btn" onclick="showPage('start-page')">ë‹¤ì‹œ í•˜ê¸°</button>
        </div>
    </div>

    <script>
        // ì „ì—­ ë³€ìˆ˜ ë° ì„¤ì •
        const pages = document.querySelectorAll('.page');
        const loader = document.getElementById('loader');
        const analyzeBtn = document.getElementById('analyze-btn');
        let modelsLoaded = false;

// [ê°œì„ ëœ] í˜ì´ì§€ ì „í™˜ í•¨ìˆ˜
function showPage(pageId) {
    pages.forEach(page => page.classList.remove('active'));
    document.getElementById(pageId).classList.add('active');

    const canvas = document.getElementById('overlay-canvas');
    const ctx = canvas.getContext('2d');
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    // [ê°œì„  3] 'ë‹¤ì‹œí•˜ê¸°' í´ë¦­ ì‹œ, ì´ì „ ì‚¬ì§„ ë° ë¶„ì„ í”ì  ì™„ë²½ ì œê±°
    if (pageId === 'start-page') {
        // íŒŒì¼ ì…ë ¥(input)ê³¼ ì´ë¯¸ì§€(img) íƒœê·¸ë¥¼ ëª¨ë‘ ì´ˆê¸°í™”
        const fileInput = document.getElementById('file-input');
        const userImage = document.getElementById('user-image');
        const slidersContainer = document.getElementById('sliders-container');
        const analyzeBtn = document.getElementById('analyze-btn');

        fileInput.value = ''; // íŒŒì¼ ì„ íƒ ìƒíƒœ ì´ˆê¸°í™”
        userImage.src = '';   // ì´ë¯¸ì§€ ì†ŒìŠ¤ ì œê±°
        userImage.style.display = 'none'; // ì´ë¯¸ì§€ ìˆ¨ê¸°ê¸°
        slidersContainer.style.display = 'none'; // ìŠ¬ë¼ì´ë” ìˆ¨ê¸°ê¸°
        analyzeBtn.style.display = 'none'; // ë¶„ì„ ë²„íŠ¼ ìˆ¨ê¸°ê¸°
    }
}

        // [ìˆ˜ì •] face-api ëª¨ë¸ ë¡œë“œ (SsdMobilenetv1 ëª¨ë¸ë¡œ ë³€ê²½)
        async function loadModels() {
            const MODEL_URL = './models';
            try {
                console.log("ëª¨ë¸ ë¡œë”©ì„ ì‹œì‘í•©ë‹ˆë‹¤...");
                await Promise.all([
                    faceapi.nets.ssdMobilenetv1.loadFromUri(MODEL_URL),
                    faceapi.nets.faceLandmark68Net.loadFromUri(MODEL_URL)
                ]);
                modelsLoaded = true;
                console.log("ëª¨ë¸ ë¡œë”© ì™„ë£Œ! ì´ì œ ì‚¬ì§„ ë¶„ì„ì„ í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.");
            } catch (error) {
                console.error("ëª¨ë¸ ë¡œë”© ì‹¤íŒ¨:", error);
                alert("ë¶„ì„ ëª¨ë¸ì„ ë¶ˆëŸ¬ì˜¤ëŠ” ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤. í˜ì´ì§€ë¥¼ ìƒˆë¡œê³ ì¹¨ í•´ì£¼ì„¸ìš”.");
            }
        }
        loadModels();

        // --- ì‚¬ì§„ ë¶„ì„ ê´€ë ¨ ìŠ¤í¬ë¦½íŠ¸ ---
        const fileInput = document.getElementById('file-input');
        const userImage = document.getElementById('user-image');
        const slidersContainer = document.getElementById('sliders-container');
        const guideContainer = document.getElementById('guide-container');

        fileInput.addEventListener('change', (event) => {
            const file = event.target.files[0];
            if (!file) return;

            // ìƒˆë¡œìš´ ì‚¬ì§„ì„ ì˜¬ë¦¬ë©´ ì´ì „ ìº”ë²„ìŠ¤ í”ì ì„ ì§€ì›ë‹ˆë‹¤.
            const canvas = document.getElementById('overlay-canvas');
            const ctx = canvas.getContext('2d');
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            const reader = new FileReader();
            reader.onload = (e) => {
                userImage.src = e.target.result;
                userImage.style.display = 'block';
                userImage.onload = () => {
                    slidersContainer.style.display = 'block';
                    analyzeBtn.style.display = 'block';
                    
                    document.getElementById('size-slider').value = 80;
                    document.getElementById('opacity-slider').value = 0.7;
                    userImage.style.width = '80%';
                    userImage.style.opacity = '0.7';
                    userImage.style.top = '50%';
                    userImage.style.left = '50%';
                };
            };
            reader.readAsDataURL(file);
        });

        // ì´ë¯¸ì§€ ë“œë˜ê·¸ ê¸°ëŠ¥
        let isImageDragging = false;
        let startX, startY, initialLeft, initialTop;
        userImage.addEventListener('mousedown', e => {
            if (!userImage.src) return;
            e.preventDefault();
            isImageDragging = true;
            userImage.style.cursor = 'grabbing';
            startX = e.clientX;
            startY = e.clientY;
            initialLeft = userImage.offsetLeft;
            initialTop = userImage.offsetTop;
            window.addEventListener('mousemove', dragImage);
            window.addEventListener('mouseup', stopDragImage);
        });

        function dragImage(e) {
            if (!isImageDragging) return;
            userImage.style.left = `${initialLeft + (e.clientX - startX)}px`;
            userImage.style.top = `${initialTop + (e.clientY - startY)}px`;
        }
        function stopDragImage() {
            isImageDragging = false;
            userImage.style.cursor = 'grab';
            window.removeEventListener('mousemove', dragImage);
            window.removeEventListener('mouseup', stopDragImage);
        }

        // ìŠ¬ë¼ì´ë” ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ
        document.getElementById('size-slider').addEventListener('input', (e) => {
            userImage.style.width = `${e.target.value}%`;
        });
        document.getElementById('opacity-slider').addEventListener('input', (e) => {
            userImage.style.opacity = e.target.value;
        });
        
async function analyzePhoto() {
    if (!modelsLoaded) {
        alert("ë¶„ì„ ëª¨ë¸ì´ ì•„ì§ ë¡œë”© ì¤‘ì…ë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.");
        return;
    }
    if (!userImage.src || userImage.style.display === 'none') {
        alert("ë¨¼ì € ì‚¬ì§„ì„ ì„ íƒí•´ì£¼ì„¸ìš”.");
        return;
    }

    loader.style.display = 'block';
    analyzeBtn.style.display = 'none';

    try {
        const detection = await faceapi.detectSingleFace(userImage, new faceapi.SsdMobilenetv1Options()).withFaceLandmarks();

        if (!detection) {
            loader.style.display = 'none';
            analyzeBtn.style.display = 'block';
            alert("ì–¼êµ´ì„ ì¸ì‹í•  ìˆ˜ ì—†ìŠµë‹ˆë‹¤. ë” ì„ ëª…í•˜ê³  ì •ë©´ì„ ë°”ë¼ë³´ëŠ” ì‚¬ì§„ì„ ì‚¬ìš©í•´ì£¼ì„¸ìš”.");
            return;
        }

        const canvas = document.getElementById('overlay-canvas');
        const ctx = canvas.getContext('2d');
        const imageRect = userImage.getBoundingClientRect();
        const containerRect = guideContainer.getBoundingClientRect();
        
        canvas.style.top = `${imageRect.top - containerRect.top}px`;
        canvas.style.left = `${imageRect.left - containerRect.left}px`;
        canvas.style.width = `${imageRect.width}px`;
        canvas.style.height = `${imageRect.height}px`;
        canvas.width = imageRect.width;
        canvas.height = imageRect.height;
        
        const displaySize = { width: imageRect.width, height: imageRect.height };
        const resizedDetections = faceapi.resizeResults(detection, displaySize);
        
        ctx.clearRect(0, 0, canvas.width, canvas.height);
        faceapi.draw.drawFaceLandmarks(canvas, resizedDetections);
        
        const landmarks = detection.landmarks;
        const jaw = landmarks.getJawOutline();
        const leftEye = landmarks.getLeftEye();
        const rightEye = landmarks.getRightEye();
        const nose = landmarks.getNose();

        // 1. ì–¼êµ´í˜•(A/B) ë¶„ì„
        const upperFacePointY = (jaw[0].y + jaw[16].y) / 2;
        const eyebrowCenterY = (landmarks.getLeftEyeBrow()[2].y + landmarks.getRightEyeBrow()[2].y) / 2;
        const upperFaceHeight = eyebrowCenterY - upperFacePointY;
        const noseCenterY = (nose[0].y + nose[3].y) / 2;
        const chinPointY = jaw[8].y;
        const lowerFaceHeight = chinPointY - noseCenterY;
        const verticalRatio = upperFaceHeight / lowerFaceHeight;
        const longFaceThreshold = 0.9;
        const faceTypeAB = (verticalRatio > longFaceThreshold) ? 'A' : 'B';

        // 2. í„±ì„ (C/D) ë¶„ì„
        const p1 = jaw[2], p2 = jaw[4], p3 = jaw[8];
        const v1 = { x: p1.x - p2.x, y: p1.y - p2.y };
        const v2 = { x: p3.x - p2.x, y: p3.y - p2.y };
        const dotProduct = v1.x * v2.x + v1.y * v2.y;
        const magnitude1 = Math.sqrt(v1.x * v1.x + v1.y * v1.y);
        const magnitude2 = Math.sqrt(v2.x * v2.x + v2.y * v2.y);
        const jawAngle = Math.acos(dotProduct / (magnitude1 * magnitude2)) * (180 / Math.PI);
        const jawAngleThreshold = 145;
        const faceTypeCD = (jawAngle < jawAngleThreshold) ? 'D' : 'C';

        // 3. ëˆˆë§¤(E/F) ë¶„ì„
        const leftEyeWidth = leftEye[3].x - leftEye[0].x;
        const leftEyeHeight = (leftEye[4].y + leftEye[5].y) / 2 - (leftEye[1].y + leftEye[2].y) / 2;
        const eyeRatio = leftEyeWidth / leftEyeHeight;
        const eyeShape = (eyeRatio < 3.0) ? 'E' : 'F';

        // 4. ì´ëª©êµ¬ë¹„(inner/outer) ë¶„ì„
        const faceWidth = jaw[16].x - jaw[0].x;
        const midEyesX = (leftEye[0].x + rightEye[3].x) / 2;
        const eyeSpreadRatio = Math.abs(midEyesX - nose[0].x) / faceWidth;
        const featurePosition = (eyeSpreadRatio < 0.03) ? 'inner' : 'outer';

        // ìµœì¢… ê²°ê³¼ ì¡°í•©
        const photoResult = {
            faceShape: faceTypeAB,
            jawLine: faceTypeCD,
            eyeShape: eyeShape,
            featurePosition: featurePosition
        };

        displayResults(photoResult, true);
        showPage('result-page');

    } catch (error) {
        console.error("ì‚¬ì§„ ë¶„ì„ ì¤‘ ì˜¤ë¥˜ ë°œìƒ:", error);
        alert("ì‚¬ì§„ì„ ë¶„ì„í•˜ëŠ” ì¤‘ì— ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì‚¬ì§„ìœ¼ë¡œ ì‹œë„í•´ë³´ê±°ë‚˜, ì„¤ë¬¸ìœ¼ë¡œ ì§„ë‹¨í•˜ëŠ” ë°©ë²•ì„ ì´ìš©í•´ì£¼ì„¸ìš”.");
    } finally {
        loader.style.display = 'none';
        analyzeBtn.style.display = 'block';
    }
}
        // ì„¤ë¬¸ ë¶„ì„ í•¨ìˆ˜
        function analyzeQuiz() {
            const form = document.getElementById('quiz-form');
            const q1 = form.elements['q1'].value;
            const q2 = form.elements['q2'].value;
            const q3 = form.elements['q3'].value;
            const q4 = form.elements['q4'].value;
            
            if (!q1 || !q2 || !q3 || !q4) {
                alert("ëª¨ë“  ì§ˆë¬¸ì— ë‹µë³€í•´ì£¼ì„¸ìš”!");
                return;
            }

            const quizResult = {
                faceShape: q1,
                jawLine: q2,
                eyeShape: q3,
                featurePosition: q4
            };
            
            displayResults(quizResult, false); // fromPhoto í”Œë˜ê·¸ë¥¼ falseë¡œ ì „ë‹¬
            showPage('result-page');
        }

        // [ìˆ˜ì •] ê²°ê³¼ í‘œì‹œ í•¨ìˆ˜ (ì‚¬ì§„ ë¶„ì„ ê¸°ë°˜ ì„¤ëª… ì¶”ê°€)
        function displayResults(analysis, fromPhoto = false) {
            const content = document.getElementById('result-content');
            
            const recommendations = {
                faceShape: {
                    A: "ì–¼êµ´ì˜ ì„¸ë¡œ ê¸¸ì´ë¥¼ ì§§ì•„ ë³´ì´ê²Œ í•˜ëŠ” **ì•„ì¹˜í˜• ëˆˆì¹**ì´ë‚˜ **ì¼ìí˜• ëˆˆì¹**ì„ ì¶”ì²œí•´ìš”. ì‹œì„ ì„ ë¶„ì‚°ì‹œì¼œ ì–¼êµ´ì´ ì§§ì•„ ë³´ì´ëŠ” íš¨ê³¼ë¥¼ ì¤ë‹ˆë‹¤.",
                    B: "ì–¼êµ´ì´ ë‹µë‹µí•´ ë³´ì´ì§€ ì•Šë„ë¡ **ì‚´ì§ ê°ì„ ì‚´ë¦° ì•„ì¹˜í˜• ëˆˆì¹**ì´ ì˜ ì–´ìš¸ë ¤ìš”. ì‹œì›í•˜ê³  ì„¸ë ¨ëœ ì¸ìƒì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                },
                jawLine: {
                    C: "ë¶€ë“œëŸ¬ìš´ ì¸ìƒì„ ì‚´ë ¤ì£¼ëŠ” **ë‘¥ê·¼ ì•„ì¹˜í˜• ëˆˆì¹**ì´ ë² ìŠ¤íŠ¸! ì–¼êµ´ì˜ ê³¡ì„ ê³¼ ì¡°í™”ë¥¼ ì´ë£¨ì–´ ìì—°ìŠ¤ëŸ½ê³  ì—¬ì„±ìŠ¤ëŸ¬ìš´ ëŠë‚Œì„ ì¤ë‹ˆë‹¤.",
                    D: "ì§ì„ ì ì¸ ëŠë‚Œì„ ì¤‘í™”ì‹œì¼œ ì¤„ **ë¶€ë“œëŸ¬ìš´ ê³¡ì„  í˜•íƒœì˜ ëˆˆì¹**ì„ ì¶”ì²œí•´ìš”. ë„ˆë¬´ ê°ì§„ ëˆˆì¹ì€ ì¸ìƒì´ ê°•í•´ ë³´ì¼ ìˆ˜ ìˆìœ¼ë‹ˆ í”¼í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤."
                },
                eyeShape: {
                    E: "ë™ê·¸ë€ ëˆˆë§¤ë¥¼ ë” ë§¤ë ¥ì ìœ¼ë¡œ ë§Œë“¤ì–´ ì¤„ **ë¶€ë“œëŸ¬ìš´ ì¼ì ëˆˆì¹**ì´ë‚˜ **ë‚®ì€ ì•„ì¹˜í˜• ëˆˆì¹**ìœ¼ë¡œ ì²­ìˆœí•œ ì´ë¯¸ì§€ë¥¼ ì—°ì¶œí•  ìˆ˜ ìˆì–´ìš”.",
                    F: "ì‹œì›í•œ ëˆˆë§¤ì™€ ì˜ ì–´ìš¸ë¦¬ëŠ” **ì„¸ë ¨ëœ ê°ì§„ ì•„ì¹˜í˜• ëˆˆì¹**ì„ ì‹œë„í•´ë³´ì„¸ìš”. ëˆˆì¹ ì‚°ì„ ì‚´ì§ ê°•ì¡°í•˜ë©´ ì´ëª©êµ¬ë¹„ê°€ ë”ìš± ë˜ë ·í•´ ë³´ì…ë‹ˆë‹¤."
                },
                featurePosition: {
                    inner: "ëˆˆì¹ì˜ ì‹œì‘ì ì„ ì‚´ì§ ë’¤ì—ì„œ ì‹œì‘í•˜ê³ , ëˆˆì¹ ê¼¬ë¦¬ë¥¼ ê¸¸ê²Œ ë¹¼ì£¼ë©´ ì‹œì„ ì´ ë°”ê¹¥ìœ¼ë¡œ ë¶„ì‚°ë˜ì–´ ê· í˜• ì¡íŒ ì¸ìƒì„ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤.",
                    outer: "ëˆˆì¹ ì•ë¨¸ë¦¬ë¥¼ ì¡°ê¸ˆ ë” ê°€ê¹ê²Œ ê·¸ë ¤ì£¼ê³ , ëˆˆì¹ ê¸¸ì´ëŠ” ë„ˆë¬´ ê¸¸ì§€ ì•Šê²Œ ì¡°ì ˆí•˜ì—¬ ì´ëª©êµ¬ë¹„ë¥¼ ëª¨ì•„ì£¼ëŠ” íš¨ê³¼ë¥¼ ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤."
                }
            };

            const photoBasisText = {
                faceShape: {
                    A: "ì´ë§ˆê°€ ë„“ê³  ê¸´ í¸",
                    B: "ì´ë§ˆê°€ ì¢ê³  ì§§ì€ í¸"
                },
                jawLine: {
                    C: "í„±ì„ ì´ ë‘¥ê·¼ í¸",
                    D: "í„±ì„ ì´ ê°ì§€ê±°ë‚˜ ë¾°ì¡±í•œ í¸"
                },
                eyeShape: {
                    E: "ëˆˆì´ ë™ê·¸ë€ í¸",
                    F: "ëˆˆì´ ê°€ë¡œë¡œ ê¸´ í¸"
                },
                featurePosition: {
                    inner: "ì´ëª©êµ¬ë¹„ê°€ ëª¨ì—¬ìˆëŠ” í¸",
                    outer: "ì´ëª©êµ¬ë¹„ê°€ í¼ì ¸ìˆëŠ” í¸"
                }
            };
            
            let resultHTML = `
                <div class="result-card">
                    <h3>ì–¼êµ´í˜• & í„±ì„ </h3>
                    <ul>
                        <li>
                            ${recommendations.faceShape[analysis.faceShape]}
                            ${fromPhoto ? `<span class="photo-basis">(ì‚¬ì§„ ë¶„ì„: ${photoBasisText.faceShape[analysis.faceShape]})</span>` : ''}
                        </li>
                        <li>
                            ${recommendations.jawLine[analysis.jawLine]}
                            ${fromPhoto ? `<span class="photo-basis">(ì‚¬ì§„ ë¶„ì„: ${photoBasisText.jawLine[analysis.jawLine]})</span>` : ''}
                        </li>
                    </ul>
                </div>
                <div class="result-card">
                    <h3>ëˆˆë§¤ & ì´ëª©êµ¬ë¹„</h3>
                    <ul>
                        <li>
                            ${recommendations.eyeShape[analysis.eyeShape]}
                            ${fromPhoto ? `<span class="photo-basis">(ì‚¬ì§„ ë¶„ì„: ${photoBasisText.eyeShape[analysis.eyeShape]})</span>` : ''}
                        </li>
                        <li>
                            ${recommendations.featurePosition[analysis.featurePosition]}
                            ${fromPhoto ? `<span class="photo-basis">(ì‚¬ì§„ ë¶„ì„: ${photoBasisText.featurePosition[analysis.featurePosition]})</span>` : ''}
                        </li>
                    </ul>
                </div>
                <div class="result-card">
                    <h3>ì¢…í•© ì¶”ì²œ ğŸ’–</h3>
                    <p>ìœ„ì˜ íŠ¹ì§•ë“¤ì„ ì¡°í•©í•˜ì—¬, ë³¸ì¸ì—ê²Œ ê°€ì¥ ì˜ ë§ëŠ” ëˆˆì¹ ëª¨ì–‘ì„ ì°¾ì•„ë³´ì„¸ìš”! ì˜ˆë¥¼ ë“¤ì–´, ê¸´ ì–¼êµ´í˜•(A)ì— ë‘¥ê·¼ í„±(C)ì´ë¼ë©´ **ë¶€ë“œëŸ¬ìš´ ì•„ì¹˜í˜• ëˆˆì¹**ì„ ê¸°ë³¸ìœ¼ë¡œ í•˜ë˜, ë„ˆë¬´ ë†’ì§€ ì•Šê²Œ ê·¸ë¦¬ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.</p>
                </div>
            `;

            content.innerHTML = resultHTML;
        }
    </script>
</body>
</html>
